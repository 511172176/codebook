\documentclass{article}
\usepackage{listings}  % 用來格式化顯示程式碼
\usepackage{xcolor}    % 用來自定義程式碼顏色
\usepackage{xeCJK}     % 支援中文
\usepackage{fancyhdr}  % 自定義頁眉頁腳
\usepackage{multicol}  % 用來分欄顯示
\usepackage{geometry}  % 調整頁邊距
\usepackage{titlesec}  % 控制標題格式
\usepackage[utf8]{inputenc} % 使用 UTF-8 編碼
\usepackage{listingsutf8} % 支援UTF-8註解顯示
\usepackage[utf8]{inputenc}
\usepackage{listingsutf8}
% 設置中文主字體
\setCJKmainfont{SimSun}

% 調整行距
\linespread{1.0}  % 保持正常行距

% 設置程式碼顯示樣式
\lstset{
  inputencoding=utf8, % 確保支持UTF-8編碼
  basicstyle=\ttfamily\small,               % 程式碼字體為 footnotesize
  keywordstyle=\bfseries\color{blue},              % 關鍵字樣式
  commentstyle=\itshape\scriptsize\color{green!50!black},  % 註解字體稍微縮小
  stringstyle=\color{red},                         % 字串顏色
  showstringspaces=false,                          % 不顯示空格
  numbers=left,                                    % 行號顯示在左邊
  numberstyle=\scriptsize\color{gray},             % 行號樣式
  stepnumber=1,                                    % 每行顯示行號
  numbersep=5pt,                                   % 行號與程式碼的間距
  breaklines=true,                                 % 開啟自動換行
  breakatwhitespace=true,                          % 在空白處換行
  tabsize=4,                                       % 設定 Tab 大小
  language=C++,                                    % 預設語言設為 C++
  columns=fullflexible                            % 減少字體間距，避免擠壓
}

% 設置頁邊距
\geometry{
  top=1in,
  bottom=1in,
  left=0.9in,    % 左邊邊距調整為 0.9in
  right=0.9in    % 右邊邊距調整為 0.9in
}

% 自定義頁眉和頁腳
\pagestyle{fancy}
\fancyhf{} % 清除預設頁眉頁腳
\fancyhead[L]{\fontsize{16}{18}\selectfont FJCU}  % 左側顯示學校名稱
\fancyhead[C]{\fontsize{16}{18}\selectfont Handmade}  % 調整頁眉中間的字體大小
\fancyhead[R]{\fontsize{16}{18}\thepage}  % 右上角顯示頁碼

% 調整標題格式，減少行與行之間的間距
\titleformat{\section}{\Large\bfseries}{}{0pt}{}
\titlespacing*{\section}{0pt}{10pt}{10pt}  % 控制 section 與上下內容的距離

% 設置分欄時的欄距和分隔線
\setlength{\columnsep}{35pt}  % 增大兩欄之間的欄距，設置為 35pt
\setlength{\columnseprule}{0.4pt}  % 設置兩欄之間的分隔線

\begin{document}

% 添加目錄
\tableofcontents  % 自動生成的目錄將在這裡顯示
\newpage  % 插入分頁，使目錄和正文分開
% 添加分欄，下面內容將分為兩欄顯示
\begin{multicols}{2}

\section{vector建樹 找尋最近共同祖先}

\lstinputlisting{C:/Users/ae887/OneDrive/桌面/codebook/code/vector建樹 找尋最近共同祖先.cpp}

\section{disjoinset並查集 路徑壓縮}

\lstinputlisting{C:/Users/ae887/OneDrive/桌面/codebook/code/disjoinset並查集路徑壓縮.cpp}

\section{vector建樹 找尋最近共同祖先}

\lstinputlisting{C:/Users/ae887/OneDrive/桌面/codebook/code/vector建樹 找尋最近共同祖先.cpp}

\end{multicols}

\end{document}
